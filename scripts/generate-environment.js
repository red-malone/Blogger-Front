const fs = require('fs');
const path = require('path');
require('dotenv').config();

const outDir = path.resolve(__dirname, '..', 'src', 'environments');
if (!fs.existsSync(outDir)) fs.mkdirSync(outDir, { recursive: true });

function writeEnvFile(filePath, obj) {
  const content = `// This file is auto-generated by scripts/generate-environment.js\nexport const environment = ${JSON.stringify(obj, null, 2)};\n`;
  fs.writeFileSync(filePath, content, { encoding: 'utf8' });
}

const dev = {
  production: false,
  apiUrl: process.env.API_URL || process.env.APP_API_URL || 'http://localhost:3000',
  appName: process.env.APP_NAME || 'Blog-Front'
};

const prod = Object.assign({}, dev, { production: true });

writeEnvFile(path.join(outDir, 'environment.ts'), dev);
writeEnvFile(path.join(outDir, 'environment.prod.ts'), prod);

console.log('Wrote environment files to', outDir);
